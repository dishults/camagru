{% extends "gallery/base.html" %}

{% block title %}
Gallery
{% endblock %}

{% block page_name %}
<h1>Gallery</h1>
{% endblock %}

{% block body %}
{% for image in object_list %}
<a name="{{ image.id }}"></a>
<img src="{{ image.image }}" class="rounded mx-auto d-block">

<div id="images" class="mx-auto">

    {% if user.is_authenticated %}
    <form method="post">
        {% csrf_token %}
        <input type="hidden" name="image" id="id_image" value="{{ image.id }}">

        <div id="likes" class="col-auto text-center">
            <button type="submit" name="button" class="btn" value="like">{{ image.like_set.count }} <span
                    class=emoji>&#x1F44D;</span></button>
        </div>

        <div class="col-auto">
            <h4>Leave a comment</h4>
            {{ form.non_field_errors }}
            <div class="fieldWrapper input-group">
                {{ form.comment.errors }}
                {{ form.comment }}
                <button type="comment" name="button" class="btn btn-outline-primary" value="comment">SEND</button>
            </div>
        </div>

        <div class="col-auto">
        </div>
    </form>

    {% else %}
    <div id="likes" class="text-center">{{ image.like_set.count }} <span class=emoji>&#x1F44D;</span></div>
    {% endif %}

    <ul id="comments" class="list-group list-group-flush">
        {% for comment in image.comment_set.all reversed %}
        <li class="list-group-item">
            {{ comment.comment }}
            <p class="mb-1">
                <span class="badge bg-primary">{{ comment.user }}</span>
                <span class="badge bg-success rounded-pill">{{ comment.date_created }}</span>
            </p>
        </li>
        {% endfor %}
    </ul>

    {% empty %}
    <p>No images yet.</p>
    {% endfor %}
</div>
{% endblock %}